# Today I Learned

|date|ver|
|----|----|
|2022-11-23| v1.0|
---
## 오늘 배운 것
### singleton
* JVM 안에 객체 한 개만 존재하는 것 

### singleton pattern
* 클래스의 인스턴스가 딱 1개만 생성되는 것을 보장하는 디자인 패턴
* static으로 메모리에 객체 올려놓고 생성자를 private으로 만들어서 new 못하게 하기

### 웹 애플리케이션에서 singleton pattern을 적용하는 이유
* 웹 애플리케이션 특성상 요청이 많다.
* 요청 올 때마다 객체를 생성하게 된다면? -> 메모리 낭비 너무 많음
* 객체 하나만 생성하고 공유하면 효율적 

### 문제점
* 구현 로직이 추가되어야 한다.
* 의존관계상 클라이언트가 구현 객체에 의존 -> DIP 위반, OCP 위반 가능성 높음
* 테스트 하기 어렵다.
* 내부 속성 변경하거나 초기화 어려움
* 유연성 떨어짐
* 안티패턴으로 불리기도 함

### singleton container
* 스프링 컨테이너(싱클톤 컨테이너)는 위 문제점 다 해결하고 객체를 싱글톤으로 관리해줌
* 스프링의 기본 bean 등록 방식은 singleton + 요청할때마다 새로운 객체 생성해서 반환하는 기능도 제공은 함(bean scope)
* 싱클톤 레지스트리

### 주의점
* 무상태로 설계해야 함
* 여러 클라이언트가 하나의 같은 객체 인스턴스를 공유하기 때문에 상태 유지되면 안됨
* 특정 클라이언트에 의존되면 안되고
* 특정 클라이언트가 값을 변경할 수 있으면 안됨
* 가급적 읽기만 가능해야 함
* 필드 대신 자바에서 공유되지 않는 지역변수, 파라미터, ThreadLocal 등 사용
* 값을 내부에서 변경하지 말고 리턴해서 처리한다던가
* 상태유지가 되면 발생하는 문제점 예) 로그인 했는데 다른 사람 정보 나옴